---
      - name: "login to registry"
        shell: docker login -u {{ registry_username }} -p {{ registry_password }} {{ containerRegistry }}
      
      - name: "stop container"
        shell: docker rm -f {{ imageRepository }} || true

      # - name: "docker pull"
      #   shell: docker pull {{ containerRegistry }}/{{ imageRepository }}:{{ TAG }} #

      - name: "docker run"
        shell: docker run -d --restart=always --name {{ imageRepository }} -p 8080:8080 {{ containerRegistry }}/{{ imageRepository }}:{{ tag }}
    
      - name: "Template a file"
        template:
          src: './.env'
          dest: '{{ homeDir }}'
          owner: '{{ user }}'
          mode: u=r,g=r,o=r

      - name: "copy env to docker"
        shell: docker cp {{ homeDir }}/.env {{ imageRepository }}:bootcamp-app\.env

      - name: "docker restart"
        shell: docker restart {{ imageRepository }}
